[
    {
        "query": "Detects the addition of a new file or path exclusion to MacOS Time Machine via the \"tmutil\" utility.\nAn adversary could exclude a path from Time Machine backups to prevent certain files from being backed up.\n",
        "expected_rule": "title: New File Exclusion Added To Time Machine Via Tmutil - MacOS\nid: 9acf45ed-3a26-4062-bf08-56857613eb52\nstatus: experimental\ndescription: |\n    Detects the addition of a new file or path exclusion to MacOS Time Machine via the \"tmutil\" utility.\n    An adversary could exclude a path from Time Machine backups to prevent certain files from being backed up.\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-12---disable-time-machine\n    - https://www.loobins.io/binaries/tmutil/\nauthor: Pratinav Chandra\ndate: 2024-05-29\ntags:\n    - attack.impact\n    - attack.t1490\nlogsource:\n    category: process_creation\n    product: macos\ndetection:\n    selection_img:\n        - Image|endswith: '/tmutil'\n        - CommandLine|contains: 'tmutil'\n    selection_cmd:\n        CommandLine|contains: 'addexclusion'\n    condition: all of selection_*\nfalsepositives:\n    - Legitimate administrator activity\nlevel: medium\n"
    },
    {
        "query": "Detects the execution of the hdiutil utility in order to create a disk image.",
        "expected_rule": "title: Disk Image Creation Via Hdiutil - MacOS\nid: 1cf98dc2-fcb0-47c9-8aea-654c9284d1ae\nstatus: experimental\ndescription: Detects the execution of the hdiutil utility in order to create a disk image.\nreferences:\n    - https://www.loobins.io/binaries/hdiutil/\n    - https://www.sentinelone.com/blog/from-the-front-linesunsigned-macos-orat-malware-gambles-for-the-win/\n    - https://ss64.com/mac/hdiutil.html\nauthor: Omar Khaled (@beacon_exe)\ndate: 2024-08-10\ntags:\n    - attack.exfiltration\nlogsource:\n    product: macos\n    category: process_creation\ndetection:\n    selection:\n        Image|endswith: /hdiutil\n        CommandLine|contains: 'create'\n    condition: selection\nfalsepositives:\n    - Legitimate usage of hdiutil by administrators and users.\nlevel: medium\n"
    },
    {
        "query": "Detects deletion attempts of MacOS Time Machine backups via the native backup utility \"tmutil\".\nAn adversary may perform this action before launching a ransonware attack to prevent the victim from restoring their files.\n",
        "expected_rule": "title: Time Machine Backup Deletion Attempt Via Tmutil - MacOS\nid: 452df256-da78-427a-866f-49fa04417d74\nstatus: experimental\ndescription: |\n    Detects deletion attempts of MacOS Time Machine backups via the native backup utility \"tmutil\".\n    An adversary may perform this action before launching a ransonware attack to prevent the victim from restoring their files.\nreferences:\n    - https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1490/T1490.md#atomic-test-12---disable-time-machine\n    - https://www.loobins.io/binaries/tmutil/\nauthor: Pratinav Chandra\ndate: 2024-05-29\ntags:\n    - attack.impact\n    - attack.t1490\nlogsource:\n    category: process_creation\n    product: macos\ndetection:\n    selection_img:\n        - Image|endswith: '/tmutil'\n        - CommandLine|contains: 'tmutil'\n    selection_cmd:\n        CommandLine|contains: 'delete'\n    condition: all of selection_*\nfalsepositives:\n    - Legitimate activities\nlevel: medium\n"
    }
]